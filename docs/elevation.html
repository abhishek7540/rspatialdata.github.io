<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Elevation data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">rspatialdata</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="admin_boundaries.html">Administrative boundaries</a>
    </li>
    <li>
      <a href="osm.html">Open Street Map data</a>
    </li>
    <li>
      <a href="population.html">Population</a>
    </li>
    <li>
      <a href="elevation.html">Elevation</a>
    </li>
    <li>
      <a href="temperature.html">Temperature</a>
    </li>
    <li>
      <a href="rainfall.html">Rainfall</a>
    </li>
    <li>
      <a href="humidity.html">Humidity</a>
    </li>
    <li>
      <a href="vegetation.html">Vegetation</a>
    </li>
    <li>
      <a href="land_cover.html">Land Cover</a>
    </li>
    <li>
      <a href="dhs-data.html">DHS</a>
    </li>
    <li>
      <a href="malaria.html">Malaria</a>
    </li>
    <li>
      <a href="air_pollution.html">Air Pollution</a>
    </li>
  </ul>
</li>
<li>
  <a href="contributors.html">Contributors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Elevation data</h1>

</div>


<div id="downloading-elevation-data-with-the-elevatr-package" class="section level1">
<h1>Downloading elevation data with the <code>elevatr</code> package</h1>
<p>This tutorial gives you a brief understanding of how to use the <code>elevatr</code> package for a standardized access to the elevation data from the web. The packages uses two endpoints to access its data from:</p>
<ul>
<li><a href="https://ned.usgs.gov/epqs/">USGS Elevation Point Query Service</a> for point elevation data (for United states only).</li>
<li><a href="https://registry.opendata.aws/terrain-tiles/">Amazon Web Services Terrain Tiles</a> for raster elevation data such as DEM (digital elevation model) (for all global elevation data).</li>
</ul>
<div id="installing-the-package" class="section level2">
<h2>Installing the package</h2>
<p>To install the <code>elevatr</code> package from CRAN use:</p>
<pre class="r"><code>install.packages(&quot;elevatr&quot;)</code></pre>
<p>And for the development version, it maybe installed with <code>devtools</code>:</p>
<pre class="r"><code>install.packages(&quot;devtools&quot;)
library(devtools)
install_github(&quot;jhollist/elevatr&quot;)</code></pre>
<p>Loading the <code>elevatr</code> package:</p>
<pre class="r"><code>library(elevatr)</code></pre>
<!--
## Datasets available 

The package has three different data sets already within it, they are namely **lake**, **pt_df**, **sp_big** , all of which are .rda files. It can be accessed by using the code `elevatr`, from which you can work with any of the above data sets and these can be saved into the working environment by assigning it to an object for further analysis and visualisation. 

You can also use other packages or own downloaded data set for showing elevation of a certain area.   



```r
elevatr::lake #SpatialPolygons Dataframe of lake Sunapee
elevatr::pt_df #small data frame of x & y locations
elevatr::sp_big #SpatialPoints of random points
```
-->
</div>
<div id="functions-available" class="section level2">
<h2>Functions available</h2>
<p>Currently, there are two functions in this package which help users access elevation web services, namely, <code>get_elev_point()</code> and <code>get_elev_raster()</code>.</p>
<p>The <code>get_elev_point()</code> function gets the point elevations using the USGS Elevation Point Query Services (for United states only) and AWS Terrain Tiles (for all global elevation data).</p>
<ul>
<li><strong>Input</strong>: This function accepts a data frame of longitude and latitude values (<code>x</code> and <code>y</code>), a <code>SpatialPoints/SpatialPointsDataFrame</code>, or a simple feature object (<code>sf</code>). It has a source argument <code>src</code> which indicates which API to use, either <code>"eqps"</code> or <code>"aws"</code>.<br />
</li>
<li><strong>Output</strong>: produces either a <code>SpatialPointsDataFrame</code> or <code>Simple Feature object</code>, depending on the class of input locations.</li>
</ul>
<p>The <code>get_elev_point()</code> function can be used as follows:</p>
<pre class="r"><code>ll_proj &lt;- &quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot;
elev &lt;- get_elev_point(pt_df, prj = ll_proj)

library(kableExtra)
elev %&gt;% kable() %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;,&quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
elevation
</th>
<th style="text-align:left;">
elev_units
</th>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:right;">
-71.82791
</td>
<td style="text-align:right;">
40.25963
</td>
</tr>
<tr>
<td style="text-align:right;">
243.79
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:right;">
-71.76843
</td>
<td style="text-align:right;">
43.05586
</td>
</tr>
<tr>
<td style="text-align:right;">
73.74
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:right;">
-71.37858
</td>
<td style="text-align:right;">
42.52338
</td>
</tr>
<tr>
<td style="text-align:right;">
86.83
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:right;">
-71.10417
</td>
<td style="text-align:right;">
42.65332
</td>
</tr>
<tr>
<td style="text-align:right;">
391.93
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:right;">
-71.56750
</td>
<td style="text-align:right;">
43.91346
</td>
</tr>
</tbody>
</table>
<p>The <code>get_elev_raster()</code> function helps user get elevation data as a raster from the AWS Open Data Terrain Tiles. The source data are global and also contain the estimations for depth for oceans.</p>
<ul>
<li><p><strong>Input</strong>: This takes in a data frame of longitude and latitude values (<code>x</code> and <code>y</code>) or any <code>sp</code> or <code>raster</code> object. It has a <code>z</code> argument to determine the zoom or resolution of the raster (1 to 14). It also has a <code>clip</code> argument to determine clipping of returned DEM. Options are <code>"tile"</code> which is the default value and returns the full tiles, <code>"bbox"</code> which returns the DEM clipped to the bounding box of the original locations, or <code>"locations"</code> if the spatial data in the input locations should be used to clip the DEM.</p></li>
<li><p><strong>Output</strong>: Returns a <code>raster</code> object of the elevation tiles that cover the bounding box of the input spatial data.</p></li>
</ul>
<!--
- When this function is used an additional column will be added to the data slot of a `SpatialPointsDataFrame` called **elevation**.

- To access data from the services you will need to set the argument `src` = `eqps`
-->
<p>We can use the <code>get_elev_raster()</code> function to obtain the elevation data of Switzerland, and plot it together with the country boundaries obtained by using the <code>rgeoboundaries</code> package as follows.</p>
<pre class="r"><code>library(ggplot2)
library(raster)
library(elevatr)
library(rgeoboundaries)
library(sf)
library(viridis)

swiss_bound &lt;- geoboundaries(&quot;Switzerland&quot;)
elevation_data &lt;- get_elev_raster(locations = swiss_bound, z = 9, clip = &quot;locations&quot;) 

elevation_data &lt;- as.data.frame(elevation_data, xy = TRUE)
colnames(elevation_data)[3] = &quot;elevation&quot;
#remove rows of data frame with one or more NA&#39;s,using complete.cases
elevation_data &lt;- elevation_data[complete.cases(elevation_data),] 

ggplot() +
  geom_raster(data = elevation_data, aes(x = x, y = y, fill = elevation)) +
  geom_sf(data = swiss_bound, color = &quot;white&quot;, fill = NA) +
  coord_sf() +
  scale_fill_viridis_c() +
  labs(title = &quot;Elevation data of Switzerland&quot;,x = &quot;Longitude&quot;, y = &quot;Latitude&quot;, fill = &quot;Elevation level(meters)&quot;)</code></pre>
<p><img src="elevation_files/figure-html/raster-elev-1.png" width="672" /></p>
<p>We can also get the different administrative areas of the country Switzerland, by using the <code>ne_states</code> function from the <code>rnaturalearth</code> package. And the <code>get_elev_raster</code> function, you can get the elevation data. The following code does the same:</p>
<p>!! NOTE: increasing or decreasing the <code>z</code> argument will make the map zoom in and out on the country by setting the appropriate z-axis value.</p>
<pre class="r"><code>library(rnaturalearth)
library(rnaturalearthhires)
sf_swiss &lt;- ne_states(country = &#39;switzerland&#39;, returnclass=&#39;sf&#39;)

elevation_1 &lt;- elevatr::get_elev_raster(locations = sf_swiss, z = 7,clip = &quot;locations&quot;)
cropped_elev &lt;- crop(elevation_1,sf_swiss)
elevate &lt;- as.data.frame(cropped_elev,xy = TRUE)

colnames(elevate)[3] = &quot;elevation_value&quot;
elevate &lt;- elevate[complete.cases(elevate),]

ggplot() +
  #geom_sf(data = st_as_sfc(st_bbox(elevation_1)),color = &quot;grey&quot;, fill = &quot;grey&quot;,alpha = 0.05) +
  geom_raster(data = elevate , aes(x = x, y = y,fill = elevation_value )) +
  geom_sf(data = sf_swiss, color = &quot;white&quot;, fill = NA) +
  coord_sf(xlim = c(5.3,10.8), ylim = c(45.5,47.8))+
  scale_fill_viridis_c()+
  labs(title = &quot;Elevation data of Switzerland&quot;,x = &quot;Longitude&quot;, y = &quot;Latitude&quot;, fill = &quot;Elevation level(meters)&quot;)</code></pre>
<p><img src="elevation_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<!--

We can also use boundary boxes for the visualisation of the elevation and can be done as thus:



```r
df <- data.frame(x = sp::bbox(lake)[1,1],
           sp::bbox(lake)[1,2],
           y = sp::bbox(lake)[2,1],
           sp::bbox(lake)[2,2])
x <- get_elev_raster(locations = df,prj = sp::proj4string(lake),z = 10)

x <- get_elev_raster(lake, z = 12)
x <- get_elev_raster(lake,src = "aws",z = 12,expand = 1300)

plot(x)
```

<img src="elevation_files/figure-html/unnamed-chunk-4-1.png" width="672" />

-->
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><code>elevatr</code> repository: <a href="https://github.com/jhollist/elevatr" class="uri">https://github.com/jhollist/elevatr</a></li>
<li><code>rgeoboundaries</code> package: <a href="https://gitlab.com/dickoa/rgeoboundaries" class="uri">https://gitlab.com/dickoa/rgeoboundaries</a></li>
<li><code>ggplot2</code> package: <a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a></li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
